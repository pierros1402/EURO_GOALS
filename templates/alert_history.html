<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EURO_GOALS v9 â€“ Unified Alert Center</title>
<link rel="icon" href="/static/icons/ball.png">
<style>
body{background:#0b0d17;color:#d1d5db;font-family:sans-serif;margin:0}
header{background:#111322;padding:1rem;display:flex;justify-content:space-between;align-items:center}
h1{color:#38bdf8;margin:0;font-size:1.2rem}
.toggle{background:#222;color:#fff;border:none;border-radius:12px;padding:6px 12px;cursor:pointer}
.container{padding:1rem}
.alert{border-radius:8px;margin-bottom:10px;padding:10px;background:#1e2133}
.goal{border-left:5px solid #38bdf8}
.smart{border-left:5px solid #facc15}
.time{font-size:0.8rem;color:#9ca3af}
.counterbar{background:#1e2133;color:#facc15;padding:8px;text-align:center;font-weight:bold}
.counterbar span{margin:0 10px}
</style>
</head>
<body>
<header>
  <h1>âš½ EURO_GOALS v9 â€“ Unified Alert Center</h1>
  <button id="soundToggle" class="toggle">ğŸ”Š Sound: ON</button>
</header>

<div class="counterbar">
  <span id="smartCount">ğŸ’° Active: 0</span>
  <span id="goalCount">âš½ Goals: 0</span>
</div>

<div class="container" id="alerts"></div>

<script>
let soundOn = true;
document.getElementById("soundToggle").onclick = () => {
  soundOn = !soundOn;
  document.getElementById("soundToggle").innerText = soundOn ? "ğŸ”Š Sound: ON" : "ğŸ”‡ Sound: OFF";
};

// Î‰Ï‡Î¿Î¹ (Ï„Î±Î¹ÏÎ¹Î¬Î¶Î¿Ï…Î½ Î¼Îµ Ï„Î± Î´Î¹ÎºÎ¬ ÏƒÎ¿Ï… Î±ÏÏ‡ÎµÎ¯Î±)
const sndGoal = new Audio("/static/sounds/goal_alert.mp3");
const sndSmart = new Audio("/static/sounds/smartmoney_alert.mp3");

let smartCount = 0, goalCount = 0;
function updateCounters(){
  document.getElementById("smartCount").innerText = `ğŸ’° Active: ${smartCount}`;
  document.getElementById("goalCount").innerText = `âš½ Goals: ${goalCount}`;
}
function addAlert(type,text){
  const div = document.createElement("div");
  div.className = "alert " + (type === "goal" ? "goal" : "smart");
  const t = new Date().toLocaleTimeString();
  div.innerHTML = `<b>${text}</b><div class='time'>${t}</div>`;
  document.getElementById("alerts").prepend(div);
  if(soundOn) (type === "goal"?sndGoal:sndSmart).play();
  if(type==="goal") goalCount++; else smartCount++;
  updateCounters();
}

// Demo polling: goal + smart
async function pollAlerts(){
  try{
    // ÎµÎ´Ï Î²Î¬Î»Îµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… endpoint goals Î±Î½ Î­Ï‡ÎµÎ¹Ï‚
    // const g = await fetch("/api/goal_alerts").then(r=>r.json());
    // if(g?.new) addAlert("goal", g.message);

    const s = await fetch("/api/smartmoney/scan").then(r=>r.json());
    if(s?.data?.length){
      s.data.forEach(a=> addAlert("smart", `ğŸ’° ${a.league} â€“ ${a.match} (${a.movement})`));
    }
  }catch(e){ console.log(e); }
  setTimeout(pollAlerts, 60000);
}
pollAlerts();
updateCounters();
</script>
</body>
</html>
