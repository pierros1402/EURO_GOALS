<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>EURO_GOALS – Admin Feeds Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/static/icon_blue.png">
  <link rel="stylesheet" href="/static/css/style_dark.css">
</head>
<body>

  <h1>📡 Admin Feeds Panel</h1>

  <table>
    <thead>
      <tr>
        <th>Feed</th>
        <th>Κατάσταση</th>
        <th>Τελευταία ενημέρωση</th>
        <th>Λεπτομέρειες</th>
      </tr>
    </thead>
    <tbody id="feedTable">
      <tr><td colspan="4">Φόρτωση δεδομένων...</td></tr>
    </tbody>
  </table>

  <div id="timestamp">Αναμονή δεδομένων...</div>

  <div class="status-bar">Παρακολούθηση feeds κάθε 60 δευτερόλεπτα</div>

  <script>
    async function loadFeeds() {
      try {
        const response = await fetch("/feeds_status");
        if (!response.ok) throw new Error("Σφάλμα HTTP " + response.status);
        const data = await response.json();
        const tbody = document.getElementById("feedTable");
        tbody.innerHTML = "";

        data.forEach(feed => {
          const row = document.createElement("tr");
          row.className = feed.status === "OK" ? "normal" : "alert";

          row.innerHTML = `
            <td>${feed.name}</td>
            <td>${feed.status}</td>
            <td>${feed.last_update || "-"}</td>
            <td>${feed.details || ""}</td>
          `;
          tbody.appendChild(row);
        });

        document.getElementById("timestamp").innerText =
          "Τελευταία ενημέρωση: " + new Date().toLocaleTimeString("el-GR");

      } catch (err) {
        console.error("Σφάλμα:", err);
        const tbody = document.getElementById("feedTable");
        tbody.innerHTML = `<tr class="alert"><td colspan="4">❌ Σφάλμα φόρτωσης feeds</td></tr>`;
        document.getElementById("timestamp").innerText = "❌ Πρόβλημα φόρτωσης δεδομένων";
      }
    }

    loadFeeds();
    setInterval(loadFeeds, 60000);
  </script>

  <div class="footer">EURO_GOALS Admin Feeds Panel v8.9g © 2025</div>

</body>
</html>
