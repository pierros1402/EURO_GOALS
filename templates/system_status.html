<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<title>⚽ EURO_GOALS – System Status Panel</title>
<link rel="icon" type="image/png" id="favicon" href="/static/icon_blue.png">
<style>
body{
  font-family:'Segoe UI',Arial,sans-serif;
  background:#0d1117;
  color:#fff;
  margin:0;
  padding:0;
}
header{
  text-align:center;
  background:#111927;
  padding:20px 0;
  border-bottom:2px solid #0b84ff;
}
header h1{
  font-size:28px;
  color:#00b0ff;
  margin:0;
  display:inline-flex;
  align-items:center;
  gap:10px;
}
header img{
  width:36px;
  height:36px;
  border-radius:50%;
  transition:filter .8s ease,transform .8s ease;
}
header img.pulse{
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{filter:drop-shadow(0 0 0px #ff4444);}
  50%{filter:drop-shadow(0 0 6px #ff4444);}
  100%{filter:drop-shadow(0 0 0px #ff4444);}
}
#status-bar{
  text-align:center;
  margin:15px auto;
  padding:10px;
  max-width:900px;
  border-radius:8px;
  font-size:16px;
  background:#1c1c1c;
  display:none;
}
#status-bar.active{display:block;}
#status-bar.ok{border:1px solid #0078d4;color:#00a2ff;background:rgba(0,90,180,0.25);}
#status-bar.error{border:1px solid #c00;color:#ff6b6b;background:rgba(180,0,0,0.25);}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:20px;
  padding:20px;
  max-width:1200px;
  margin:auto;
}
.card{
  background:#161b22;
  border:1px solid #242b35;
  border-radius:12px;
  padding:16px;
  text-align:center;
  box-shadow:0 0 8px rgba(0,0,0,0.3);
}
.card h2{color:#00b0ff;margin-bottom:8px;}
.ok{color:#4ef04e;}
.fail{color:#ff4c4c;}
footer{text-align:center;color:#888;margin:30px 0 20px;font-size:13px;}
</style>
</head>

<body>
<header>
  <h1>
    <img id="statusIcon" src="/static/icon_blue.png" alt="Status">
    EURO_GOALS – System Status Panel
  </h1>
</header>

<div id="status-bar"></div>

<main class="grid">
  <div class="card"><h2>Render</h2><p class="ok">Online</p></div>
  <div class="card"><h2>Database</h2><p>PostgreSQL<br><small>Auto-Fallback ενεργό</small></p></div>
  <div class="card"><h2>API Router</h2><p class="ok">Feeds Active</p></div>
  <div class="card"><h2>Smart Money</h2><p class="fail">0/0 active</p></div>
</main>

<audio id="alertSound" src="/static/sounds/alert.mp3" preload="auto"></audio>

<script>
const icon=document.getElementById('statusIcon');
const bar=document.getElementById('status-bar');
const sound=document.getElementById('alertSound');
let lastStatus="";

async function checkStatus(){
  try{
    const res=await fetch("/check_asianconnect");
    const data=await res.json();

    if(data.status==="DOWN"||data.status==="NO_KEY"){
      icon.src="/static/icon_red.png";
      icon.classList.add("pulse");
      bar.textContent=data.banner||"Asianconnect API: DOWN – Auto-Fallback ενεργό";
      bar.className="active error";
      if(lastStatus!=="DOWN"){sound.play().catch(()=>{});}
      lastStatus="DOWN";
    }else{
      icon.src="/static/icon_blue.png";
      icon.classList.remove("pulse");
      bar.textContent="Asianconnect: OK";
      bar.className="active ok";
      if(lastStatus==="DOWN"){sound.play().catch(()=>{});}
      lastStatus="OK";
    }
  }catch(e){
    icon.src="/static/icon_red.png";
    icon.classList.add("pulse");
    bar.textContent="Σφάλμα σύνδεσης με το API.";
    bar.className="active error";
    if(lastStatus!=="DOWN"){sound.play().catch(()=>{});}
    lastStatus="DOWN";
  }
}

// first run + auto refresh
checkStatus();
setInterval(checkStatus,60000);
</script>

<footer>EURO_GOALS v8.9k – Soft Pulse Edition (Auto-Refresh + Alert Animation)</footer>
</body>
</html>
