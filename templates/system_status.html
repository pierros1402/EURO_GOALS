<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>âš½ EURO_GOALS v9.1 â€“ System Status Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/static/icon_blue.png">
  <link rel="stylesheet" href="/static/css/style_dark.css">

  <style>
    body { color:#fff; background:#0d1117; font-family:'Segoe UI',Arial,sans-serif; }

    .led { display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:8px;box-shadow:0 0 5px rgba(0,0,0,0.4); }
    .led.ok { background:#00ff66;box-shadow:0 0 6px #00ff66; }
    .led.fail { background:#ff3333;box-shadow:0 0 6px #ff3333; }
    .led.pending { background:#ffcc00;box-shadow:0 0 6px #ffcc00; }

    table {width:90%;margin:auto;border-collapse:collapse;}
    th,td {padding:8px 10px;text-align:center;border-bottom:1px solid #222;}
    th {background:#111927;color:#00b0ff;}
    tr.alert {background:rgba(255,0,0,0.08);}
    tr.normal:hover {background:rgba(255,255,255,0.05);}

    #alert-panel {
      background:#161b22;
      border:1px solid #333;
      border-radius:10px;
      width:90%;
      margin:30px auto;
      padding:10px 20px;
      box-shadow:0 0 10px rgba(0,176,255,0.15);
    }
    #alert-panel h2 {
      color:#00b0ff;
      margin-bottom:10px;
      text-align:center;
    }
    #alertList {
      list-style:none;
      padding:0;
      margin:0;
      max-height:250px;
      overflow-y:auto;
    }
    #alertList li {
      padding:6px 10px;
      border-bottom:1px solid #222;
      font-size:14px;
    }
    .smart { color:#00ff99; }
    .goal { color:#00b0ff; }
    .system { color:#ffcc00; }

    .timestamp {
      color:#777;
      font-size:12px;
      margin-left:10px;
    }

    #timestamp {text-align:center;margin-top:10px;color:#00b0ff;}
  </style>
</head>

<body>
  <h1 style="text-align:center;">ğŸ§  EURO_GOALS v9.1 â€“ Dual Data Engine</h1>

  <table id="statusTable">
    <thead>
      <tr>
        <th>ÎœÎ·Ï‡Î±Î½Î®</th>
        <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
        <th>Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·</th>
      </tr>
    </thead>
    <tbody id="statusBody">
      <tr><td colspan="3">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½...</td></tr>
    </tbody>
  </table>

  <div id="timestamp">Î‘Î½Î±Î¼Î¿Î½Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½...</div>

  <!-- ğŸ§© Recent Alerts Panel -->
  <div id="alert-panel">
    <h2>ğŸ“¡ Recent Alerts (SmartMoney + GoalMatrix)</h2>
    <ul id="alertList"><li>Î¦ÏŒÏÏ„Ï‰ÏƒÎ· ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ‰Î½...</li></ul>
  </div>

  <script>
    async function updateStatus(){
      try {
        const res = await fetch("/status");
        const data = await res.json();
        const tbody = document.getElementById("statusBody");
        tbody.innerHTML = "";
        for(const [engine, info] of Object.entries(data)){
          const row=document.createElement("tr");
          let ledClass="pending";
          if(info.status==="active") ledClass="ok";
          else if(info.status==="error") ledClass="fail";
          row.innerHTML = `
            <td>${engine}</td>
            <td><span class="led ${ledClass}"></span>${info.status}</td>
            <td>${info.last_update}</td>
          `;
          tbody.appendChild(row);
        }
        document.getElementById("timestamp").innerText = "Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï‚ Î­Î»ÎµÎ³Ï‡Î¿Ï‚: "+new Date().toLocaleTimeString("el-GR");
      } catch (err){
        console.error("Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ /status:",err);
      }
    }

    async function updateAlerts(){
      try{
        const res = await fetch("/alerts");
        const data = await res.json();
        const list = document.getElementById("alertList");
        list.innerHTML = "";
        data.slice(0,10).forEach(a=>{
          const li=document.createElement("li");
          const cls = a.source.toLowerCase();
          li.className = cls;
          li.innerHTML = `<b>${a.source}</b>: ${a.message}<span class="timestamp">${a.timestamp}</span>`;
          list.appendChild(li);
        });
      }catch(err){
        console.error("Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ /alerts:",err);
      }
    }

    updateStatus();
    updateAlerts();
    setInterval(updateStatus, 60000);
    setInterval(updateAlerts, 90000);
  </script>

  <div style="text-align:center;color:#777;margin-top:20px;">EURO_GOALS v9.1 Â© 2025</div>
</body>
</html>
